<?php
/**
 * @file
 */

/*
 * Implements hook_menu()
 */
function bosa_iframe_menu(){
  $items = array();

  $items['bosa/iframe'] = array(
    'page callback' => 'bosa_iframe_view',
    'access arguments' => array('view published content'),
  );

  return $items;
}

/**
 * Implements hook_page_alter()
 */
function bosa_iframe_page_alter(&$page) {
  if(arg(0) == 'bosa' && arg(1) == 'iframe'){
    unset($page['page_top']);
    unset($page['footer']);
    unset($page['above-header']);
  }
}

/**
 * Implements hook_preprocess_page()
 */
function bosa_iframe_preprocess_page(&$vars, $hook) {
  $pathargs = explode('/',request_uri());
  if ($pathargs[2] == 'bosa' && $pathargs[3] == 'iframe') {
     $vars['theme_hook_suggestion'] = 'page__iframe';
  }
}

function bosa_iframe_view($type, $arg, $ids = NULL){

  switch($type){
    // Product view
    // bosa/iframe/product/<s:specified/r:random>/<optional: product node ids>
    case 'product':
      $v = views_get_view('Produktvisning_paa_kategoriside');
      switch($arg){
        case 's':
          return $v->preview('panel_pane_2', array($ids));
        
        default:
          $v->set_items_per_page($ids);
          return $v->preview('panel_pane_2');
      }
      break;

    // Category view
    // bosa/iframe/category/<number of categories>/<category ids>
    case 'category':
      $v = views_get_view('kategorivisning');
      switch($arg){
        case 's':
          return $v->preview('panel_pane_1', array($ids));
        
        default:
          $v->set_items_per_page($ids);
          return $v->preview('panel_pane_1');
      }
      break;

    default:
      return 'Incorrect arguments';
      break;
  }
}

